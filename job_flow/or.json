{
  "Applications": [
    {
      "Name": "Hadoop"
    },
    {
      "Name": "Spark"
    }
  ],
  "BootstrapActions": [
    {
      "Name": "bootstrap_emr",
      "ScriptBootstrapAction": {
        "Path": "s3://{{ var.value.Bootstrap_Bucket }}/bootstrap.sh"
      } // Set bootstrap_bucket in Airflow variables
    }
  ],
  "Configurations": [
    {
      "Classification": "spark-env",
      "Configurations": [
        {
          "Classification": "export",
          "Properties": {
            "PYSPARK_PYTHON": "/usr/bin/python3" //Amazon EMR release versions 5.20.0 and later: Python 3.6 is installed on the cluster instances. For 5.20.0-5.29.0, Python 2.7 is the system default. For Amazon EMR version 5.30.0 and later, Python 3 is the system default.
          }
        }
      ]
    }
  ],
  "Instances": {
    "Ec2KeyName": "{{ var.value.Ec2_Key_Name }}", // Set Ec2KeyName and Ec2SubnetId in Airflow variables // Check Ec2KeyName and Ec2SubnetId
    "Ec2SubnetId": "{{ var.value.Ec2_Subnet_Id }}",
    "InstanceGroups": [
      {
        "InstanceCount": 1,
        "InstanceRole": "MASTER",
        "InstanceType": "m5.xlarge",
        "Market": "ON_DEMAND",
        "Name": "Primary_Node"
      },
      {
        "InstanceCount": 2,
        "InstanceRole": "CORE",
        "InstanceType": "m5.xlarge",
        "Market": "ON_DEMAND",
        "Name": "Core_Node_2"
      }
    ],
    "KeepJobFlowAliveWhenNoSteps": false,
    "TerminationProtected": false
  },
  "JobFlowRole": "{{ var.value.Job_Flow_Role }}", // Use AWS CLI for searching JobFlowRole and ServiceRole: >> aws iam list-roles | grep "EMR_DefaultRole\|EMR_EC2_DefaultRole" // Set JobFlowRole and ServiceRole in Airflow variables
  "LogUri": "s3://{{ var.value.Log_Bucket }}/emrlogs/",
  "Name": "Udacity_Capstone_Spark_On_EMR",
  "ReleaseLabel": "emr-5.29.0",
  "ServiceRole": "{{ var.value.Service_Role }}",
  "VisibleToAllUsers": true
}